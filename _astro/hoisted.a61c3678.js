const N=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,x=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,I=/^\s*["[{]|^\s*-?\d[\d.]{0,14}\s*$/;function A(e,n){if(e!=="__proto__"&&!(e==="constructor"&&n&&typeof n=="object"&&"prototype"in n))return n}function $(e,n={}){if(typeof e!="string")return e;const o=e.toLowerCase().trim();if(o==="true")return!0;if(o==="false")return!1;if(o==="null")return null;if(o==="nan")return Number.NaN;if(o==="infinity")return Number.POSITIVE_INFINITY;if(o!=="undefined"){if(!I.test(e)){if(n.strict)throw new SyntaxError("Invalid JSON");return e}try{return N.test(e)||x.test(e)?JSON.parse(e,A):JSON.parse(e)}catch(r){if(n.strict)throw r;return e}}}const k=/#/g,q=/&/g,U=/=/g,S=/\+/g,v=/%5e/gi,F=/%60/gi,J=/%7c/gi,G=/%20/gi;function Q(e){return encodeURI(""+e).replace(J,"|")}function m(e){return Q(typeof e=="string"?e:JSON.stringify(e)).replace(S,"%2B").replace(G,"+").replace(k,"%23").replace(q,"%26").replace(F,"`").replace(v,"^")}function h(e){return m(e).replace(U,"%3D")}function T(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function W(e){return T(e.replace(S," "))}function B(e=""){const n={};e[0]==="?"&&(e=e.slice(1));for(const o of e.split("&")){const r=o.match(/([^=]+)=?(.*)/)||[];if(r.length<2)continue;const a=T(r[1]);if(a==="__proto__"||a==="constructor")continue;const i=W(r[2]||"");typeof n[a]<"u"?Array.isArray(n[a])?n[a].push(i):n[a]=[n[a],i]:n[a]=i}return n}function D(e,n){return(typeof n=="number"||typeof n=="boolean")&&(n=String(n)),n?Array.isArray(n)?n.map(o=>`${h(e)}=${m(o)}`).join("&"):`${h(e)}=${m(n)}`:h(e)}function H(e){return Object.keys(e).filter(n=>e[n]!==void 0).map(n=>D(n,e[n])).join("&")}const M=/^\w{2,}:([/\\]{1,2})/,z=/^\w{2,}:([/\\]{2})?/,K=/^([/\\]\s*){2,}[^/\\]/;function _(e,n={}){return typeof n=="boolean"&&(n={acceptRelative:n}),n.strict?M.test(e):z.test(e)||(n.acceptRelative?K.test(e):!1)}const V=/\/$|\/\?/;function g(e="",n=!1){return n?V.test(e):e.endsWith("/")}function X(e="",n=!1){if(!n)return(g(e)?e.slice(0,-1):e)||"/";if(!g(e,!0))return e||"/";const[o,...r]=e.split("?");return(o.slice(0,-1)||"/")+(r.length>0?`?${r.join("?")}`:"")}function Y(e="",n=!1){if(!n)return e.endsWith("/")?e:e+"/";if(g(e,!0))return e||"/";const[o,...r]=e.split("?");return o+"/"+(r.length>0?`?${r.join("?")}`:"")}function Z(e=""){return e.startsWith("/")}function ee(e=""){return(Z(e)?e.slice(1):e)||"/"}function te(e,n){if(oe(n)||_(e))return e;const o=X(n);return e.startsWith(o)?e:se(o,e)}function ne(e,n){const o=O(e),r={...B(o.search),...n};return o.search=H(r),ae(o)}function oe(e){return!e||e==="/"}function re(e){return e&&e!=="/"}function se(e,...n){let o=e||"";for(const r of n.filter(a=>re(a)))o=o?Y(o)+ee(r):r;return o}function O(e="",n){if(!_(e,{acceptRelative:!0}))return n?O(n+e):y(e);const[o="",r,a=""]=(e.replace(/\\/g,"/").match(/([^/:]+:)?\/\/([^/@]+@)?(.*)/)||[]).splice(1),[i="",s=""]=(a.match(/([^#/?]*)(.*)?/)||[]).splice(1),{pathname:u,search:f,hash:t}=y(s.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:o,auth:r?r.slice(0,Math.max(0,r.length-1)):"",host:i,pathname:u,search:f,hash:t}}function y(e=""){const[n="",o="",r=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:n,search:o,hash:r}}function ae(e){const n=e.pathname+(e.search?(e.search.startsWith("?")?"":"?")+e.search:"")+e.hash;return e.protocol?e.protocol+"//"+(e.auth?e.auth+"@":"")+e.host+n:n}class ie extends Error{constructor(){super(...arguments),this.name="FetchError"}}function ce(e,n,o){let r="";n&&(r=n.message),e&&o?r=`${r} (${o.status} ${o.statusText} (${e.toString()}))`:e&&(r=`${r} (${e.toString()})`);const a=new ie(r);return Object.defineProperty(a,"request",{get(){return e}}),Object.defineProperty(a,"response",{get(){return o}}),Object.defineProperty(a,"data",{get(){return o&&o._data}}),Object.defineProperty(a,"status",{get(){return o&&o.status}}),Object.defineProperty(a,"statusText",{get(){return o&&o.statusText}}),Object.defineProperty(a,"statusCode",{get(){return o&&o.status}}),Object.defineProperty(a,"statusMessage",{get(){return o&&o.statusText}}),a}const ue=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function w(e="GET"){return ue.has(e.toUpperCase())}function fe(e){if(e===void 0)return!1;const n=typeof e;return n==="string"||n==="number"||n==="boolean"||n===null?!0:n!=="object"?!1:Array.isArray(e)?!0:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const le=new Set(["image/svg","application/xml","application/xhtml","application/html"]),pe=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function de(e=""){if(!e)return"json";const n=e.split(";").shift()||"";return pe.test(n)?"json":le.has(n)||n.startsWith("text/")?"text":"blob"}const he=new Set([408,409,425,429,500,502,503,504]);function P(e){const{fetch:n,Headers:o}=e;function r(s){const u=s.error&&s.error.name==="AbortError"||!1;if(s.options.retry!==!1&&!u){let t;typeof s.options.retry=="number"?t=s.options.retry:t=w(s.options.method)?0:1;const c=s.response&&s.response.status||500;if(t>0&&he.has(c))return a(s.request,{...s.options,retry:t-1})}const f=ce(s.request,s.error,s.response);throw Error.captureStackTrace&&Error.captureStackTrace(f,a),f}const a=async function(u,f={}){const t={request:u,options:{...e.defaults,...f},response:void 0,error:void 0};t.options.onRequest&&await t.options.onRequest(t),typeof t.request=="string"&&(t.options.baseURL&&(t.request=te(t.request,t.options.baseURL)),(t.options.query||t.options.params)&&(t.request=ne(t.request,{...t.options.params,...t.options.query})),t.options.body&&w(t.options.method)&&fe(t.options.body)&&(t.options.body=typeof t.options.body=="string"?t.options.body:JSON.stringify(t.options.body),t.options.headers=new o(t.options.headers),t.options.headers.has("content-type")||t.options.headers.set("content-type","application/json"),t.options.headers.has("accept")||t.options.headers.set("accept","application/json"))),t.response=await n(t.request,t.options).catch(async l=>(t.error=l,t.options.onRequestError&&await t.options.onRequestError(t),r(t)));const c=(t.options.parseResponse?"json":t.options.responseType)||de(t.response.headers.get("content-type")||"");if(c==="json"){const l=await t.response.text(),L=t.options.parseResponse||$;t.response._data=L(l)}else c==="stream"?t.response._data=t.response.body:t.response._data=await t.response[c]();return t.options.onResponse&&await t.options.onResponse(t),t.response.status>=400&&t.response.status<600?(t.options.onResponseError&&await t.options.onResponseError(t),r(t)):t.response},i=function(u,f){return a(u,f).then(t=>t._data)};return i.raw=a,i.native=n,i.create=(s={})=>P({...e,defaults:{...e.defaults,...s}}),i}const j=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),me=j.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),ge=j.Headers,ye=P({fetch:me,Headers:ge}),we="https://v3.football.api-sports.io/",p={},Ee=ye.create({baseURL:we,headers:{"x-rapidapi-host":"v3.football.api-sports.io"},onResponse({request:e,response:n,options:o}){}});function be(e,n,o={}){const r=JSON.stringify(n);return p[e]?.[r]?$(p[e]?.[r]):Ee(e,{...o,params:n}).then(a=>(p[e]=p[e]||{},p[e][r]=JSON.stringify(a),a))}const Re=new Set(["lastOpponent","lastScore","leaguePosition","manager","nextOpponent","numGamesPlayed","playingNow","winLossRecord"]),$e=e=>{const n=e%10,o=e%100;return n===1&&o!==11?e+"st":n===2&&o!==12?e+"nd":n===3&&o!==13?e+"rd":e+"th"},d=(e,n,o="s")=>`${e} ${n}${e>1?o:""}`,Se=(e,n="s")=>`${e}'${e.endsWith(n)?"":n}`;async function Te(e,n,o,r){const a={headers:{"x-rapidapi-key":o}},i=(t,c)=>be(t,c,a);let s=n;if(!s.id&&(s=(await i("/teams",n)).response.pop()?.team,!s))return"Couldn't find team";const u=s.id,f="2022";switch(e){case"lastOpponent":{const t=(await i("/fixtures",{team:u,last:1})).response.pop(),c=t?Object.values(t.teams||{}).filter(l=>!new RegExp(s?.name||"").test(l.name)).pop():void 0;return c?`${s.name} played against ${c.name} last.`:"Couldn't find opponent"}case"lastScore":{const t=(await i("/fixtures",{team:u,last:1})).response.pop();return t?.goals?`${Se(s.name)} last score was ${Object.values(t.goals).join("-")}.`:"Couldn't find score"}case"leaguePosition":{const t=(await i("/standings",{season:f,team:u})).response.filter(c=>["Premier League"].includes(c.league.name)).pop()?.league?.standings?.pop()?.pop();return t?`${s.name} are in ${$e(t.rank)} place in the ${t.group} standings.`:"Couldn't find standing"}case"manager":{const t=(await i("/coachs",{team:u})).response.pop();return t?`The manager/coach for ${s.name} is ${t.name}`:"Couldn't find manager"}case"nextGameDate":{const t=(await i("/fixtures",{team:u,next:1})).response.pop()?.fixture.date;return t?`${s.name} are playing on ${new Date(t).toLocaleString("en-GB")} next.`:"Couldn't find opponent"}case"nextOpponent":{const t=(await i("/fixtures",{team:u,next:1})).response.pop(),c=t?Object.values(t.teams||{}).filter(l=>!new RegExp(s?.name||"").test(l.name)).pop():void 0;return c?`${s.name} are playing against ${c.name} next.`:"Couldn't find opponent"}case"numGamesPlayed":{const t=(await i("/standings",{season:f,team:u})).response.filter(c=>["Premier League"].includes(c.league.name)).pop()?.league?.standings?.pop()?.pop();return t?`${s.name} have played ${d(t.all.played,"match","es")} in the ${t.group} standings so far.`:"Couldn't find standing"}case"playingNow":return(await i("/fixtures",{team:u,live:"all",season:f})).response.pop()?"Yes":"No";case"winLossRecord":{const t=(await i("/standings",{season:f,team:u})).response.filter(c=>["Premier League"].includes(c.league.name)).pop()?.league?.standings?.pop()?.pop();return t?`${s.name} have ${d(t.all.win,"win")}, ${d(t.all.lose,"lose")} and ${d(t.all.draw,"draw")} in the ${t.group} standings so far.`:"Couldn't find standing"}case"default_teamInfo":{let t;if(!s.founded){const c=(await i("/teams",{id:u})).response.pop();s=c?.team,t=c?.venue}return s?`${s.name}, founded in ${s.founded} are from ${s.country}${t?` and their home is ${t.name} in ${t.city}`:""}.`:"Couldn't find team"}default:return r}}async function _e(e,n,o="I don't know that"){const r=(Array.isArray(e.info)?e.info:[e.info||"default_teamInfo"]).filter(a=>Re.has(a));return r.length===0?o:(await Promise.all(r.map(a=>Te(a,e.team,n,o)))).join(". ")}const Oe=document.querySelector("form.input-area"),Pe=document.querySelector("div#chat"),E=document.querySelector("span#loading-text");function b(e,n="user-message"){const o=document.createElement("div");o.className=n,o.appendChild(document.createTextNode(e)),Pe.appendChild(o)}function R(e,n){return e[n]||[]}Oe.onsubmit=()=>{const e=document.querySelector("input#input-message"),n=document.querySelector("input#wit-ai-token")?.value,o=document.querySelector("input#api-football-token")?.value;return E.style.display="block",fetch(`https://api.wit.ai/message?v=20230215&q=${encodeURIComponent(e.value)}`,{headers:{Authorization:`Bearer ${n}`}}).then(r=>r.json()).then(({entities:r})=>{const a=window.localStorage.getItem("current_team"),i=R(r,"Team:Team").pop()?.body,s=i?{name:i}:a?JSON.parse(a):void 0,u=R(r,"InfoType:InfoType").map(f=>f.value);window.localStorage.setItem("current_team",JSON.stringify(s)),(s?_e({team:s,info:u},o):Promise.resolve("What team?")).then(f=>{b(e.value),e.value="",b(f,"bot-message")}).then(()=>{E.style.display="none"})}),!1};const C=(()=>typeof localStorage<"u"&&localStorage.getItem("theme")?localStorage.getItem("theme"):window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")();C==="light"?document.documentElement.classList.remove("dark"):document.documentElement.classList.add("dark");window.localStorage.setItem("theme",C||"");const je=()=>{const e=document.documentElement;e.classList.toggle("dark");const n=e.classList.contains("dark");localStorage.setItem("theme",n?"dark":"light")};document.getElementById("theme-toggle")?.addEventListener("click",je);
